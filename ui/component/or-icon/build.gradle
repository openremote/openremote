buildDir = "dist"

tasks.register('copyMdiFont', Exec) {
    dependsOn getYarnInstallTask()
    // Using yarn throws an error relating to node_module resolution
    commandLine 'bash', '-c', 'npm run copyMdiFont'
}

tasks.register('clean') {
    doLast {
        delete "dist"
        delete "lib"
    }
}

tasks.register('prepareUi') {
    dependsOn clean, npmAnalyze, npmPrepare
}

tasks.register('publishUi') {
    dependsOn clean, npmPublish
}

tasks.register('installDist', Copy) {
    dependsOn getYarnInstallTask(), copyMdiFont, npmAnalyze
    resolveTask(":ui:app:shared:generateSources").dependsOn it
    from "${buildDir}/Material Design Icons"
    into "${project(':ui:app:shared').projectDir}/fonts/Material Design Icons"
}

tasks.register('npmBuild', Exec) {
    mustRunAfter npmClean
    dependsOn getYarnInstallTask()
    commandLine npmCommand("yarn"), "run", "build"
}
